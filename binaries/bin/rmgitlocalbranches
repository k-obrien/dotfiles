#!/usr/bin/env zsh

source common

depend_on git


[[ -z "$1" ]] || [[ "$1" == "-d" ]] || [[ "$1" == "-D" ]] || error_exit "Usage: rmgitlocal [options]\n\t-[dD]\tDelete merged branches"

git remote prune origin

branches=($(git branch -vv | grep 'origin/.*: gone]' | awk '{print $1}'))

for branch in "${branches[@]}"; do
    if [[ -z "$1" ]]; then
        echo "$branch"
    else
        git branch "$1" "$branch"
    fi
done
